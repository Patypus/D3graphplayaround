<head>
    <title>Stacked Bar</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.9/d3.min.js" charset="utf-8"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js" charset="utf-8"></script>
    <script src="Data.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="gas-styles.css">
</head>
<body>
    <div class="container">
        <div id="graph">

        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            var graph = d3.select("#graph");
            var nameOffset = 85; //pixel width of the planet-name div with padding.

            for (var i = 0; i < data.length; i++) {
                var container = graph.append("div")
                                     .classed("bar-container", true);

                container.append("div")
                         .classed("planet-name", true)
                         .append("span")
                         .text(data[i].Planet);

                var bar = container.append("div");

                var widthExcludingName = $(bar[0]).width();

                var scale = d3.scale.linear();
                scale.domain([0, 100])
                scale.range([0, widthExcludingName]);

                CreateSingleStackedBar(bar, data[i].Atmosphere, scale);
            }

              
        });

        function CreateSingleStackedBar(element, atmospheres, scale) {
            var containerWidth = $(element[0]).width();

            console.log(atmospheres);

            element.selectAll("div")
                   .data(atmospheres)
                   .enter()
                   .append("div")
                   .attr("class", function (d) { return "bar-segment " + d.DataClass })
                   .style("width", function (d) { return scale(d.Percent) + "px"; })
                   .append("span")
                   .text(function (d) { return d.Gas + ": " + d.Percent + "%" });
        } 

    </script>
</body>